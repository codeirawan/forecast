CREATE PROCEDURE forecast.avg_history_by_forecast_id(IN forecast_id INT)
begin
	SELECT
    forecast_id,
    start_date,
    end_date,
     mon,
     tue,
     wed,
     thu,
     fri,
     sat,
     sun,
    (mon + tue + wed + thu + fri + sat + sun) AS sum,
    ((mon + tue + wed + thu + fri + sat + sun) / 7) AS avg
  FROM forecast.calculations
  WHERE forecast_id = forecast_id
  GROUP BY forecast_id,   mon,
     tue,
     wed,
     thu,
     fri,
     sat,
     sun,
 limit 1;
END
